"use strict"; (self["webpackChunkjianyi"] = self["webpackChunkjianyi"] || []).push([[690], { 2368: function (t, e, i) { i.d(e, { $w: function () { return o }, Kk: function () { return s }, YB: function () { return a } }); var n = i(4040); function s() { return (0, n.Z)({ url: "/notes", method: "get" }) } function o(t) { return (0, n.Z)({ url: "/note/" + t }) } function a(t) { return (0, n.Z)({ url: "note/" + t + "/comment" }) } }, 1690: function (t, e, i) { i.r(e), i.d(e, { default: function () { return d } }); var n = function () { var t = this, e = t._self._c; return e("div", { staticClass: "notes" }, [e("van-sticky", [e("div", { staticClass: "notesTop" }, [t._v("手记")])]), t.noteList ? e("div", t._l(t.noteList, (function (i, n) { return e("router-link", { key: i.id, staticClass: "noteInfo", attrs: { tag: "div", to: "/notesdetail?id=" + i.id } }, [e("div", { staticClass: "top" }, [e("div", { staticClass: "img", on: { click: function (e) { return e.preventDefault(), t.goUserView(i.user.id) } } }, [e("img", { attrs: { src: i.user.avatar, alt: "" } })]), e("div", { staticClass: "topText" }, [e("p", { staticClass: "name", on: { click: function (e) { return e.preventDefault(), t.goUserView(i.user.id) } } }, [t._v(" " + t._s(i.user.username) + " ")]), e("p", { staticClass: "times" }, [t._v(" " + t._s(t._f("changeTimeFormat")(1e3 * i.addtime)) + " 发布 ")])]), e("span", { staticClass: "iconfont icon-gengduo1", on: { click: function (e) { e.preventDefault(), t.showShare = !0 } } })]), e("h3", { staticClass: "title" }, [t._v(t._s(i.title))]), e("div", { staticClass: "contentText" }, [e("p", { staticClass: "content" }, [t._v(t._s(i.content))])]), i.images ? e("div", { staticClass: "pics" }, t._l(i.images, (function (t) { return e("div", { key: t, staticClass: "pic" }, [e("img", { attrs: { src: t, alt: "" } })]) })), 0) : t._e(), i.article.cover ? e("router-link", { staticClass: "videoView", attrs: { tag: "div", to: "/videoplay?id=" + i.article.id } }, [e("div", { staticClass: "img" }, [e("img", { attrs: { src: i.article.cover, alt: "" } })]), e("div", { staticClass: "text" }, [e("p", { staticClass: "title" }, [t._v(t._s(i.article.title))]), e("p", { staticClass: "name" }, [t._v("@" + t._s(i.article.author.userinfo.username))])])]) : t._e(), e("div", { staticClass: "bottom" }, [e("div", [e("span", { class: ["iconfont", "icon-dianzan1", { likeactive: i.isliked }], on: { click: function (e) { return e.stopPropagation(), t.dianzan(n) } } }), e("p", [t._v(t._s(i.count.count_liked))])]), e("div", [e("span", { staticClass: "iconfont icon-pinglun" }), e("p", [t._v(t._s(i.count.count_commented))])]), 0 != i.count.count_shared ? e("div", { on: { click: function (e) { e.preventDefault(), t.showShare = !0 } } }, [e("span", { staticClass: "iconfont icon-fenxiang" }), e("p", [t._v(t._s(i.count.count_shared))])]) : e("div", { on: { click: function (e) { e.preventDefault(), t.showShare = !0 } } }, [e("span", { staticClass: "iconfont icon-fenxiang" }), e("p", [t._v("分享")])])])], 1) })), 1) : e("div", { staticClass: "loadingView" }, [e("div", { staticClass: "loading" }), e("van-loading", { attrs: { type: "spinner", size: "20", vertical: "" } })], 1), e("van-share-sheet", { attrs: { title: "立即分享给好友", options: t.options }, model: { value: t.showShare, callback: function (e) { t.showShare = e }, expression: "showShare" } }), e("tab-bar", { attrs: { "tab-index": t.tabIndex } })], 1) }, s = [], o = i(2368), a = i(1281), l = { data() { return { noteList: null, showShare: !1, tabIndex: 2, loginPhone: "", isliked: !1, options: [[{ name: "微信", icon: "wechat" }, { name: "朋友圈", icon: "wechat-moments" }, { name: "微博", icon: "weibo" }, { name: "QQ", icon: "qq" }], [{ name: "复制链接", icon: "link" }, { name: "分享海报", icon: "poster" }, { name: "二维码", icon: "qrcode" }, { name: "小程序码", icon: "weapp-qrcode" }]] } }, methods: { getNotesFun() { (0, o.Kk)().then((t => { this.noteList = t.data.list; let e = localStorage.getItem("notelikeList"); if (!e) return; let i = JSON.parse(e), n = i.findIndex((t => t.phone == this.loginPhone)); if (-1 == n) return; let s = i[n].noteIds; for (let o = 0; o < this.noteList.length; o++) { let t = s.findIndex((t => t == this.noteList[o].id)); -1 != t && (this.noteList[o].isliked = !0, this.noteList[o].count.count_liked += 1) } })) }, goUserView(t) { this.$router.push({ name: "userinfo", query: { id: t } }) }, dianzan(t) { let e = this; if ("" == this.loginPhone) return void this.$dialog.confirm({ title: "未登录", message: "是否跳转到登录页面" }).then((() => { e.$router.push("/loginview") })); let i = localStorage.getItem("notelikeList"), n = []; if (i) { n = JSON.parse(i); let e = n.findIndex((t => t.phone == this.loginPhone)); if (-1 == e) n.push({ phone: this.loginPhone, noteIds: [this.noteList[t].id] }), this.noteList[t].count.count_liked += 1, this.noteList[t].isliked = !0; else { let i = n[e].noteIds, s = i.findIndex((e => e == this.noteList[t].id)); -1 == s ? (n[e].noteIds.push(this.noteList[t].id), this.noteList[t].count.count_liked += 1, this.noteList[t].isliked = !0) : (n[e].noteIds.splice(s, 1), this.noteList[t].count.count_liked -= 1, this.noteList[t].isliked = !1) } } else n.push({ phone: this.loginPhone, noteIds: [this.noteList[t].id] }), this.noteList[t].count.count_liked += 1, this.noteList[t].isliked = !0; n = JSON.stringify(n), localStorage.setItem("notelikeList", n) }, findloginPhone() { let t = localStorage.getItem("userlist"), e = []; if (!t) return; e = JSON.parse(t); let i = e.findIndex((t => "login" == t.type)); -1 != i && (this.loginPhone = e[i].phone) } }, created() { this.getNotesFun(), this.findloginPhone() }, filters: { changeTimeFormat(t) { var e, i = new Date(t), n = i.getFullYear(), s = i.getMonth() + 1, o = i.getDate(), a = i.getHours(), l = i.getMinutes(), c = i.getTime(), r = new Date, u = r.getTime(), d = 0; return d = u - c, e = d <= 6e4 ? "刚刚" : 6e4 < d && d <= 36e5 ? Math.round(d / 6e4) + "分钟前" : 36e5 < d && d <= 864e5 ? Math.round(d / 36e5) + "小时前" : 864e5 < d && d <= 1296e6 ? Math.round(d / 864e5) + "天前" : d > 1296e6 && n === r.getFullYear() ? s + "-" + o + " " + a + ":" + l : n + "-" + s + "-" + o + " " + a + ":" + l, e } }, components: { TabBar: a.Z } }, c = l, r = i(2349), u = (0, r.Z)(c, n, s, !1, null, null, null), d = u.exports } }]);
//# sourceMappingURL=690.66e44876.js.map